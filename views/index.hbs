<!-- Slider -->
<section class="section-slide">
	<div class="wrap-slick1">
		<div class="slick1">
			<div class="item-slick1" style="background-image: url(images/slide-01.jpg);">
				<div class="container h-full">
					<div class="flex-col-l-m h-full p-t-100 p-b-30 respon5">
						<div class="layer-slick1 animated visible-false" data-appear="fadeInDown" data-delay="0">
							<span class="ltext-101 clwhite respon2">
								Bộ sưu tập 
							</span>
						</div>

						<div class="layer-slick1 animated visible-false" data-appear="fadeInUp" data-delay="800">
							<h2 class="ltext-201 clwhite p-t-19 p-b-43 respon1">
								Nguyễn Nhật Ánh
							</h2>
						</div>

						<div class="layer-slick1 animated visible-false" data-appear="zoomIn" data-delay="1600">
							<a href="/search-author?search_author=nguyễn+nhật+ánh"
								class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04">
								Vào xem ngay
							</a>
						</div>
					</div>
				</div>
			</div>

			<div class="item-slick1" style="background-image: url(images/slide-02.jpg);">
				<div class="container h-full">
					<div class="flex-col-l-m h-full p-t-100 p-b-30 respon5">
						<div class="layer-slick1 animated visible-false" data-appear="rollIn" data-delay="0">
							<span class="ltext-101 clwhite respon2">
								Bộ sưu tập
							</span>
						</div>

						<div class="layer-slick1 animated visible-false" data-appear="lightSpeedIn" data-delay="800">
							<h2 class="ltext-201 clwhite p-t-19 p-b-43 respon1">
								Harry Potter
							</h2>
						</div>

						<div class="layer-slick1 animated visible-false" data-appear="slideInUp" data-delay="1600">

							<a href="/search-title?search_title=harry"
								class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04">
								Vào xem ngay
							</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<!-- Product -->


<section class="bg0 p-t-23 p-b-140">
	<div class="container">
		<div class="p-b-10">
			<h3 class="ltext-103 cl5">
				Tổng quan sản phẩm
			</h3>
		</div>

		<div class="flex-w flex-sb-m p-b-52">
			
			<div class="flex-w flex-c-m m-tb-10">
				<div class="flex-c-m stext-106 cl6 size-104 bor4 pointer hov-btn3 trans-04 m-r-8 m-tb-4 js-show-filter">
					<i class="icon-filter cl2 m-r-6 fs-15 trans-04 zmdi zmdi-filter-list"></i>
					<i class="icon-close-filter cl2 m-r-6 fs-15 trans-04 zmdi zmdi-close dis-none"></i>
					Lọc
				</div>

				<div class="flex-c-m stext-106 cl6 size-105 bor4 pointer hov-btn3 trans-04 m-r-8 m-tb-4 js-show-search">
					<i class="icon-search cl2 m-r-6 fs-15 trans-04 zmdi zmdi-search"></i>
					<i class="icon-close-search cl2 m-r-6 fs-15 trans-04 zmdi zmdi-close dis-none"></i>
					Tìm kiếm
				</div>
				<span id="begin-product"></span>
				<span>&ensp;-&ensp;</span> 
				<span id="end-product"> 50</span> 
				<span>&ensp;trong tổng số&ensp;</span>
				<span id="total-product">{{total}}</span>
			</div>

			<!-- Search product -->
			<div class="dis-none panel-search w-full p-t-10 p-b-15">
				<form action="/search-title" method = "GET" class="bor8 dis-flex p-l-15">
					<button class="size-113 flex-c-m fs-16 cl2 hov-cl1 trans-04">
						<i class="zmdi zmdi-search"></i>
					</button>

					<input class="mtext-107 cl2 size-114 plh2 p-r-15" type="text" name="search_title"
						placeholder="Nhập tên sách cần tìm">
				</form>
			</div>

			<div class="dis-none panel-search w-full p-t-10 p-b-15">
				<form action="/search-author" method = "GET" class="bor8 dis-flex p-l-15">
					<button class="size-113 flex-c-m fs-16 cl2 hov-cl1 trans-04">
						<i class="zmdi zmdi-search"></i>
					</button>

					<input class="mtext-107 cl2 size-114 plh2 p-r-15" type="text" name="search_author"
						placeholder="Nhập tên tác giả cần tìm">
				</form>
			</div>


			<!-- Filter -->
			<div class="dis-none panel-filter w-full p-t-10">
				<div class="wrap-filter flex-w bg6 w-full p-lr-40 p-t-27 p-lr-15-sm">
					<div class="filter-col1 p-r-15 p-b-27">
						<div class="mtext-102 cl2 p-b-15">
							Nhà xuất bản
						</div>


						<!-- hbs lọc theo publisher -->
						<ul class="filter-tope-group m-tb-10">
							{{# each publish }}
							<li class="p-b-6">
								<button class="stext-106 cl6 hov1 bor3 trans-04 m-r-32 m-tb-5"
									data-filter=".{{this.publisherID}}">
									{{this.publisher}}
								</button>
							</li>
							{{/each}}

						</ul>
						<!-- end hbs lọc theo publisher -->

					</div>

					<div class="filter-col2 p-r-15 p-b-27">
						<div class="mtext-102 cl2 p-b-15">
							Sắp xếp
						</div>

						<ul>
							<li class="p-b-6">
								<a href="/" class="stext-106 cl6 hov1 bor3 trans-04 m-r-32 m-tb-5">
									Sắp xếp theo tên
								</a>

							</li>

							<li class="p-b-6">
								<a href="/?sort=1" class="stext-106 cl6 hov1 bor3 trans-04 m-r-32 m-tb-5">
									Sắp xếp theo giá tăng dần
								</a>
							</li>

							<li class="p-b-6">
								<a href="/?sort=-1" class="stext-106 cl6 hov1 bor3 trans-04 m-r-32 m-tb-5">
									Sắp xếp theo giá giảm dần
								</a>
							</li>

						</ul>
					</div>
					<!-- hbs lọc theo categories -->
					<div class="filter-col4 p-b-27 ">
						<div class="mtext-102 cl2 p-b-15">
							Thể loại
						</div>
						<div class="flex-w p-t-4 m-r--5 filter-tope-group">
						<button class="flex-c-m stext-107 cl6 size-301 bor7 p-lr-15 hov-tag1 trans-04 m-r-5 m-b-5 "data-filter="*">Tất cả</button>
						{{# each categories }}			
							<button class="flex-c-m stext-107 cl6 size-301 bor7 p-lr-15 hov-tag1 trans-04 m-r-5 m-b-5 "data-filter=".{{this.categoriesID}}">
								{{this.categories}}
							</button>
						{{/ each }}
							
						</div>
					</div>
					<!-- end hbs lọc theo categories -->
				</div>
			</div>
		</div>

		<div class="row isotope-grid">

			<!-- hbs hiễn thị sản phẩm -->
			{{# each items }}
			<div class="col-sm-6 col-md-4 col-lg-3 p-b-35 isotope-item {{{this.categoriesID}}} {{{this.publisherID}}}">
				<!-- Block2 -->
				<div class="block2">
					<div class="block2-pic hov-img0">
						<img src={{this.img.[0]}} alt="IMG-PRODUCT" width="270" height="360">
						<a href="" id="{{this.id}}"
							class="btn-show-quickly block2-btn flex-c-m stext-103 cl2 size-102 bg0 bor2 hov-btn1 p-lr-15 trans-04 js-show-modal1">
							Xem nhanh
						</a>
					</div>

					<div class="block2-txt flex-w flex-t p-t-14">
						<div class="block2-txt-child1 flex-col-l ">
							<a href="/product-detail?id={{this.id}}"
								class="stext-104 cl4 hov-cl1 trans-04 js-name-b2 p-b-6">
								{{this.title}}
							</a>

							<span class="stext-105 cl3">
								{{this.price}}₫
							</span>
						</div>

						<div class="block2-txt-child2 flex-r p-t-3">
							<a href="#" class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11">
								<i class="zmdi zmdi-shopping-cart"></i>
							</a>
						</div>
					</div>
				</div>
			</div>
			{{/each}}
			<!-- end hbs hiễn thị sản phẩm -->
		</div>
		<!-- Load more -->
		<div class="flex-c-m flex-w w-full p-t-45">
			<ul id="page-number">
				<a class="first-page">
					<li>&lt;&lt;</li>
				</a>		
			</ul>
		</div>
	</div>
</section>



<!-- Modal1 -->

<div class="wrap-modal1 js-modal1 p-t-60 p-b-20">
	<div class="overlay-modal1 js-hide-modal1"></div>
	<div class="container">
		<div class="bg0 p-t-60 p-b-30 p-lr-15-lg how-pos3-parent">
			<button class="how-pos3 hov3 trans-04 js-hide-modal1">
				<img src="images/icons/icon-close.png" alt="CLOSE">
			</button>
			<div id="popUp" class="row"></div>
		</div>
	</div>
</div>

<script>
	 $(document).ready(function (){
		//number products
		const products_per_page = 5;
		const total_products = parseInt($('#total-product').text());

		let searchParams = new URLSearchParams(window.location.search);
		var page = searchParams.get('page');
		if(page==null)
			page = 0;
		parse = parseInt(page);
		var begin_product;
		if(total_products > 0)
			begin_product = page*products_per_page + 1;
		var end_product;
		if(begin_product + products_per_page - 1 > total_products)
			end_product = total_products;
		else
			end_product = begin_product + products_per_page - 1;
		$('#begin-product').text(begin_product);
		$('#end-product').text(end_product);


		//page number
		page++;
		var max_page = parseInt(total_products/products_per_page);
		if (total_products % products_per_page != 0)
			 max_page += 1;
		if ((page - 2 >= 1) && (page + 2 <= max_page)) {
			for (var i = page - 2; i <= page + 2; i++)
				$('#page-number').append("<a  class='page-link-number'><li class='page-item-number'>" + i + "</li></a>");
		}else if((page - 2 < 1) && (max_page>=5)){
			for (var i = 1; i <= 5; i++)
				$('#page-number').append("<a  class='page-link-number'><li class='page-item-number'>" + i + "</li></a>");
		}else if((max_page>=5) && (page + 2 > max_page)){
			for (var i = max_page-4; i <= max_page; i++)
				$('#page-number').append("<a class='page-link-number'><li class='page-item-number'>" + i + "</li></a>");
		}else{
			for (var i = 1; i <= max_page; i++)
				$('#page-number').append("<a class='page-link-number'><li class='page-item-number'>" + i + "</li></a>");
		}
		
		const length = $('.page-item-number').length;
		const firts_number = parseInt($('.page-item-number').eq(0).text());
		const index_active = page-firts_number;
		$('.page-item-number').eq(index_active).addClass("page-active");
		$('#page-number').append("<a class='last-page'><li>&gt;&gt;</li></a>");
					
		//click on page number
		$('.page-item-number').on('click', function(){
			if(page==parseInt($(this).text()))
				return false;
			page = parseInt($(this).text()) - 1;
			var url = "/?page=" + page;
        	window.location.href = url;
		});

		//click on first/last page
		$('.first-page').on('click', function(){
			if(page==1)
				return false;
			page = 0;
			const url = "/?page=" + page;
        	window.location.href = "/?page=0";
		});
		$('.last-page').on('click', function(){
			if(page==max_page)
				return false;
			page = max_page-1;
			var url = "/?page=" + page;
        	window.location.href = url;
		});

	})	

	
</script>